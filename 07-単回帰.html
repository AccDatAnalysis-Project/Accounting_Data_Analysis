<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 単回帰分析とCVP分析 | 会計情報のデータ分析</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 単回帰分析とCVP分析 | 会計情報のデータ分析" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 単回帰分析とCVP分析 | 会計情報のデータ分析" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="北田智久・濵村純平・井上謙仁　編" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="06-会計情報の検定.html"/>
<link rel="next" href="08-重回帰.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">目次</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>まえがき</a></li>
<li class="chapter" data-level="1" data-path="01-会計情報データを統計分析.html"><a href="01-会計情報データを統計分析.html"><i class="fa fa-check"></i><b>1</b> 会計情報を統計分析する：必要性と困難性</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01-会計情報データを統計分析.html"><a href="01-会計情報データを統計分析.html#会計情報を統計分析するとは"><i class="fa fa-check"></i><b>1.1</b> 「会計情報を統計分析する」とは？</a></li>
<li class="chapter" data-level="1.2" data-path="01-会計情報データを統計分析.html"><a href="01-会計情報データを統計分析.html#実証的な会計研究からの示唆コスト変動研究と利益調整研究"><i class="fa fa-check"></i><b>1.2</b> 実証的な会計研究からの示唆：「コスト変動研究」と「利益調整研究」</a></li>
<li class="chapter" data-level="1.3" data-path="01-会計情報データを統計分析.html"><a href="01-会計情報データを統計分析.html#企業内部で会計情報の統計分析を実施できない理由"><i class="fa fa-check"></i><b>1.3</b> 企業内部で会計情報の統計分析を実施「できない」理由</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-会計データへのアクセス.html"><a href="02-会計データへのアクセス.html"><i class="fa fa-check"></i><b>2</b> 会計データへのアクセス</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-会計データへのアクセス.html"><a href="02-会計データへのアクセス.html#会計データを入手し整理する"><i class="fa fa-check"></i><b>2.1</b> 会計データを入手し，整理する</a></li>
<li class="chapter" data-level="2.2" data-path="02-会計データへのアクセス.html"><a href="02-会計データへのアクセス.html#edinetの使い方"><i class="fa fa-check"></i><b>2.2</b> EDINETの使い方</a></li>
<li class="chapter" data-level="2.3" data-path="02-会計データへのアクセス.html"><a href="02-会計データへのアクセス.html#整然データとは"><i class="fa fa-check"></i><b>2.3</b> 整然データとは</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-Rの準備.html"><a href="03-Rの準備.html"><i class="fa fa-check"></i><b>3</b> R・Rstudioの準備と基本操作</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-Rの準備.html"><a href="03-Rの準備.html#この章について"><i class="fa fa-check"></i><b>3.1</b> この章について</a></li>
<li class="chapter" data-level="3.2" data-path="03-Rの準備.html"><a href="03-Rの準備.html#インストール"><i class="fa fa-check"></i><b>3.2</b> インストール</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="03-Rの準備.html"><a href="03-Rの準備.html#rのインストール"><i class="fa fa-check"></i><b>3.2.1</b> Rのインストール</a></li>
<li class="chapter" data-level="3.2.2" data-path="03-Rの準備.html"><a href="03-Rの準備.html#rstudioのインストール"><i class="fa fa-check"></i><b>3.2.2</b> RStudioのインストール</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="03-Rの準備.html"><a href="03-Rの準備.html#rstudioの基本操作とrの基礎知識"><i class="fa fa-check"></i><b>3.3</b> RStudioの基本操作とRの基礎知識</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="03-Rの準備.html"><a href="03-Rの準備.html#rstudioの基本操作"><i class="fa fa-check"></i><b>3.3.1</b> RStudioの基本操作</a></li>
<li class="chapter" data-level="3.3.2" data-path="03-Rの準備.html"><a href="03-Rの準備.html#rの基礎知識"><i class="fa fa-check"></i><b>3.3.2</b> Rの基礎知識</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-会計情報の前処理.html"><a href="04-会計情報の前処理.html"><i class="fa fa-check"></i><b>4</b> 会計情報を前処理する</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-会計情報の前処理.html"><a href="04-会計情報の前処理.html#この章について-1"><i class="fa fa-check"></i><b>4.1</b> この章について</a></li>
<li class="chapter" data-level="4.2" data-path="04-会計情報の前処理.html"><a href="04-会計情報の前処理.html#データの読込操作"><i class="fa fa-check"></i><b>4.2</b> データの読込・操作</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="04-会計情報の前処理.html"><a href="04-会計情報の前処理.html#データの読込"><i class="fa fa-check"></i><b>4.2.1</b> データの読込</a></li>
<li class="chapter" data-level="4.2.2" data-path="04-会計情報の前処理.html"><a href="04-会計情報の前処理.html#データの操作"><i class="fa fa-check"></i><b>4.2.2</b> データの操作</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="04-会計情報の前処理.html"><a href="04-会計情報の前処理.html#データの結合"><i class="fa fa-check"></i><b>4.3</b> データの結合</a></li>
<li class="chapter" data-level="4.4" data-path="04-会計情報の前処理.html"><a href="04-会計情報の前処理.html#財務指標の作成"><i class="fa fa-check"></i><b>4.4</b> 財務指標の作成</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-会計情報の可視化.html"><a href="05-会計情報の可視化.html"><i class="fa fa-check"></i><b>5</b> 会計情報の可視化</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-会計情報の可視化.html"><a href="05-会計情報の可視化.html#この章について-2"><i class="fa fa-check"></i><b>5.1</b> この章について</a></li>
<li class="chapter" data-level="5.2" data-path="05-会計情報の可視化.html"><a href="05-会計情報の可視化.html#つのグラフを出力する"><i class="fa fa-check"></i><b>5.2</b> 1つのグラフを出力する</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="05-会計情報の可視化.html"><a href="05-会計情報の可視化.html#ggplotの記述方法"><i class="fa fa-check"></i><b>5.2.1</b> ggplotの記述方法</a></li>
<li class="chapter" data-level="5.2.2" data-path="05-会計情報の可視化.html"><a href="05-会計情報の可視化.html#ヒストグラムと箱ひげ図"><i class="fa fa-check"></i><b>5.2.2</b> ヒストグラムと箱ひげ図</a></li>
<li class="chapter" data-level="5.2.3" data-path="05-会計情報の可視化.html"><a href="05-会計情報の可視化.html#折れ線グラフ"><i class="fa fa-check"></i><b>5.2.3</b> 折れ線グラフ</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="05-会計情報の可視化.html"><a href="05-会計情報の可視化.html#複数のグラフを出力する"><i class="fa fa-check"></i><b>5.3</b> 複数のグラフを出力する</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06-会計情報の検定.html"><a href="06-会計情報の検定.html"><i class="fa fa-check"></i><b>6</b> 会計情報を検定する</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-会計情報の検定.html"><a href="06-会計情報の検定.html#この章について-3"><i class="fa fa-check"></i><b>6.1</b> この章について</a></li>
<li class="chapter" data-level="6.2" data-path="06-会計情報の検定.html"><a href="06-会計情報の検定.html#用語説明"><i class="fa fa-check"></i><b>6.2</b> 用語説明</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="06-会計情報の検定.html"><a href="06-会計情報の検定.html#母集団と標本"><i class="fa fa-check"></i><b>6.2.1</b> 母集団と標本</a></li>
<li class="chapter" data-level="6.2.2" data-path="06-会計情報の検定.html"><a href="06-会計情報の検定.html#有意水準"><i class="fa fa-check"></i><b>6.2.2</b> 有意水準</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="06-会計情報の検定.html"><a href="06-会計情報の検定.html#t検定"><i class="fa fa-check"></i><b>6.3</b> t検定</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="06-会計情報の検定.html"><a href="06-会計情報の検定.html#対応のない二群のt検定"><i class="fa fa-check"></i><b>6.3.1</b> 対応のない二群のt検定</a></li>
<li class="chapter" data-level="6.3.2" data-path="06-会計情報の検定.html"><a href="06-会計情報の検定.html#相関係数"><i class="fa fa-check"></i><b>6.3.2</b> 相関係数</a></li>
<li class="chapter" data-level="6.3.3" data-path="06-会計情報の検定.html"><a href="06-会計情報の検定.html#相関係数の検定"><i class="fa fa-check"></i><b>6.3.3</b> 相関係数の検定</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07-単回帰.html"><a href="07-単回帰.html"><i class="fa fa-check"></i><b>7</b> 単回帰分析とCVP分析</a>
<ul>
<li class="chapter" data-level="7.1" data-path="07-単回帰.html"><a href="07-単回帰.html#cvp分析とは"><i class="fa fa-check"></i><b>7.1</b> CVP分析とは</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="07-単回帰.html"><a href="07-単回帰.html#固定費と変動費"><i class="fa fa-check"></i><b>7.1.1</b> 固定費と変動費</a></li>
<li class="chapter" data-level="7.1.2" data-path="07-単回帰.html"><a href="07-単回帰.html#固変分解の方法"><i class="fa fa-check"></i><b>7.1.2</b> 固変分解の方法</a></li>
<li class="chapter" data-level="7.1.3" data-path="07-単回帰.html"><a href="07-単回帰.html#cvp分析における仮定"><i class="fa fa-check"></i><b>7.1.3</b> CVP分析における仮定</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="07-単回帰.html"><a href="07-単回帰.html#最小二乗法を利用した固変分解"><i class="fa fa-check"></i><b>7.2</b> 最小二乗法を利用した固変分解</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="07-単回帰.html"><a href="07-単回帰.html#データの確認"><i class="fa fa-check"></i><b>7.2.1</b> データの確認</a></li>
<li class="chapter" data-level="7.2.2" data-path="07-単回帰.html"><a href="07-単回帰.html#最小二乗法に関する予備知識"><i class="fa fa-check"></i><b>7.2.2</b> 最小二乗法に関する予備知識</a></li>
<li class="chapter" data-level="7.2.3" data-path="07-単回帰.html"><a href="07-単回帰.html#最小二乗法の実践"><i class="fa fa-check"></i><b>7.2.3</b> 最小二乗法の実践</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="08-重回帰.html"><a href="08-重回帰.html"><i class="fa fa-check"></i><b>8</b> コストビヘイビアを推定する</a>
<ul>
<li class="chapter" data-level="8.1" data-path="08-重回帰.html"><a href="08-重回帰.html#費用構造が変化した場合の費用直線の推定"><i class="fa fa-check"></i><b>8.1</b> 費用構造が変化した場合の費用直線の推定</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="08-重回帰.html"><a href="08-重回帰.html#ダミー変数"><i class="fa fa-check"></i><b>8.1.1</b> ダミー変数</a></li>
<li class="chapter" data-level="8.1.2" data-path="08-重回帰.html"><a href="08-重回帰.html#グループごとに固定費のみを変えたい場合"><i class="fa fa-check"></i><b>8.1.2</b> グループごとに固定費のみを変えたい場合</a></li>
<li class="chapter" data-level="8.1.3" data-path="08-重回帰.html"><a href="08-重回帰.html#グループごとに固定費および変動費率を変えたい場合"><i class="fa fa-check"></i><b>8.1.3</b> グループごとに固定費および変動費率を変えたい場合</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="08-重回帰.html"><a href="08-重回帰.html#コストドライバー分析"><i class="fa fa-check"></i><b>8.2</b> コストドライバー分析</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="08-重回帰.html"><a href="08-重回帰.html#重回帰分析"><i class="fa fa-check"></i><b>8.2.1</b> 重回帰分析</a></li>
<li class="chapter" data-level="8.2.2" data-path="08-重回帰.html"><a href="08-重回帰.html#残差回帰"><i class="fa fa-check"></i><b>8.2.2</b> 残差回帰</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">ここ何書こうかしら</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">会計情報のデータ分析</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="ch7" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> 単回帰分析とCVP分析</h1>
<p>【応用例】</p>
<ul>
<li>損益分岐点分析（CVP分析）</li>
</ul>
<p>【関連する会計研究】</p>
<ul>
<li>福嶋誠宣・新井康平 (2012) 「企業レベルでのコストビヘイビア推定」, 『Hirao School of Management Review』, Vol. 2, 1–7.</li>
</ul>
<div id="cvp分析とは" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> CVP分析とは</h2>
<p></p>
<p>CVP分析とは，コスト（Cost），売上高（Volume），利益（Profit）の相互関係（CVP関係ともいう）を用いて行われる分析のことをさす<a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a>。
ただし，データの入手の困難性から，CVP分析を行う際にはVolumeとして売上高が利用されることが多い。
これらの3つには「利益 <span class="math inline">\(=\)</span> 売上高 <span class="math inline">\(-\)</span> コスト」という関係がある。この関係をベースとして，さまざまな分析がなされる。
最も代表的な分析はCVP関係を基礎として行われる損益分岐点分析である。
ある調査によれば，CVP分析は6割強の企業で利用されており<span class="citation">(<a href="08-重回帰.html#ref-YFS2017Cbook" role="doc-biblioref">吉田, 福島, and 妹尾 2017, 67</a>)</span>，実務的にも非常に重要な分析ツールである。</p>
<p>CVP分析は短期（会計分野では通常，1年以内）の利益計画を策定する際にその力を発揮する。
なぜなら，CVP分析では，売上高や販売量，コスト，および利益の関係について条件を変えてシミュレーションできるからである。</p>
<p>たとえば，来期の営業利益目標が100億円だった場合に，CVP分析を利用して目標となる売上高や販売量を計算できる。
また，企業努力によりコスト削減に成功した場合に，それが利益に与える影響を確かめることもできる。</p>
<p>ただし，企業が公表している財務会計に則った財務数値のみでは即座に，CVP分析を行うことはできない。
なぜなら，CVP分析を行うためには，コストを固定費と変動費に分類しなければならないからである。
そこで，本章では，CVP分析を行う際の固定費と変動費に関したコスト関数の推定方法を紹介する。</p>
<div id="固定費と変動費" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> 固定費と変動費</h3>
<p></p>
<p>先述したように，CVP分析を行うは，コストを固定費と変動費に分けて考える。このコストの分類方法は原価を操業度の観点から分類している<a href="#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a>。
固定費とは売上高に関連なく発生する原価のことをさす（図<a href="07-単回帰.html#fig:costs">7.1</a>：左側）。
たとえば，毎月定額支払わなければならない家賃や正社員に対する給料が固定費となる。
なぜなら，こうしたコストはたとえ製品が全く売れなくても，また工場が操業していなくても発生するからである。</p>
<p>一方，変動費とは，売上高に応じて変化する原価のことをさす（図<a href="07-単回帰.html#fig:costs">7.1</a>：右側）。
たとえば，製品を製造するための主要な材料が変動費になることが多い。</p>
<div class="figure" style="text-align: center"><span id="fig:costs"></span>
<img src="pics_pdf/TK6.1.png" alt="固定費と変動費" width="500px" />
<p class="caption">
Figure 7.1: 固定費と変動費
</p>
</div>
<p>それではなぜコストを固定費と変動費に分ける必要があるのだろうか。
コストを固定費と変動費に分解することによって，たとえば，売上高が2倍となった場合にコストがいくらになるかが判明し，それとともに利益がいくらになるかがわかる。</p>
<p>もし仮に，コストを固定費と変動費に分解できなければ，操業度や売上高が変化した際にコストがどれだけ変化するのかわからない。
すると，必然的に利益もいくら変化するかがわからなくなる。
したがって，CVP分析においてはコストを固定費と変動費に分解することが重要となる。
これによって，短期の利益計画の策定といった意思決定に有用な情報をもたらす。</p>
<p>固定費・変動費という2つのコスト概念を合わせると，企業の総コストは図<a href="07-単回帰.html#fig:ttlcost">7.2</a>で表すことができる。</p>
<div class="figure" style="text-align: center"><span id="fig:ttlcost"></span>
<img src="pics_pdf/TK6.2.png" alt="総コスト" width="500px" />
<p class="caption">
Figure 7.2: 総コスト
</p>
</div>
<p>ここで，コストを<span class="math inline">\(y\)</span>，売上高を<span class="math inline">\(x\)</span>と表現し，図<a href="07-単回帰.html#fig:ttlcost">7.2</a>の総コストについて売上高を用いて数式で表現すると，</p>
<p><span class="math display">\[\begin{align*}
    y=\alpha +\beta x,
\end{align*}\]</span></p>
<p>となる。
いま，<span class="math inline">\(\alpha\)</span>は固定費を，<span class="math inline">\(\beta\)</span>は変動費率を，<span class="math inline">\(\beta x\)</span>は変動費を表す。
図<a href="07-単回帰.html#fig:ttlcost">7.2</a>にさらに売上高を表す直線を加えると，図<a href="07-単回帰.html#fig:cvp">7.3</a>になる。</p>
<div class="figure" style="text-align: center"><span id="fig:cvp"></span>
<img src="pics_pdf/TK6.3.png" alt="CVP関係" width="500px" />
<p class="caption">
Figure 7.3: CVP関係
</p>
</div>
<p>なお，総コスト線と売上高線が交わる点を損益分岐点という。
損益分岐点とは，総費用と売上高が一致しており，利益も損失もゼロとなる点である。
したがって，企業が利益を確保するためには，損益分岐点を超えるような売上高ないしは販売量を達成する必要がある。</p>
<p>総コスト線が求まることで，損益分岐点分析や目標利益を達成するために必要な売上高を求めるといったCVP分析が可能となる。</p>
</div>
<div id="固変分解の方法" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> 固変分解の方法</h3>
<p></p>
<p>コストを固定費と変動費に分解する方法（固変分解ともいう）はいくつか存在する。本章ではとくにその中でも最小二乗法による固変分解に焦点を合わせるが，その前に他の固変分解の方法も紹介する。</p>
<p>勘定科目別精査法は過去の経験にもとづいて，コストを勘定科目ごとに固定費と変動費に分類する方法である。この方法は，費目別精査法ともよばれる。</p>
<p>また，スキャッター・チャート法はこれまでに実現した原価の実績データをグラフ化し，これらの点の真ん中を通る原価直線を目分量で引く方法である。</p>
<p>さらに，高低点法もスキャッター・チャート法と同様に，過去のある期間内における実績データを用いる。ただし，高低点法では，最高の営業量のときと最低の営業量のときの2点のデータを用いて，コストを営業量1単位あたりの変動費（変動費率）と固定費に分類する。このとき，変動費率と固定費はそれぞれ次のように計算される。</p>
<p><span class="math display">\[\begin{align*}
     &amp; \mbox{変動費率}=\frac{\mbox{最高の売上高のときのコスト}-\mbox{最低の売上高のときのコスト}}{\mbox{最高の売上高}-\mbox{最低の売上高}}, \\
    &amp;\mbox{固定費}=\mbox{最高（最低）の売上高のときのコスト}-\mbox{最高（最低）のときの売上高の変動費}, 
\end{align*}\]</span></p>
<p>たとえば，自動車のドアを製造しているとある工場において，1月から6月について，コストと売上高に関して，次のような実績データが得られたとする。なお，1月から6月のいずれの売上高も正常な範囲内であるとする。コストと売上高の単位は億円とする。</p>
<table>
<caption><span id="tab:data">Table 7.1: </span>売上高とコストのデータ</caption>
<thead>
<tr class="header">
<th align="left">月</th>
<th align="left">売上高</th>
<th align="left">コスト</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1月</td>
<td align="left">300</td>
<td align="left">16</td>
</tr>
<tr class="even">
<td align="left">2月</td>
<td align="left">310</td>
<td align="left">15</td>
</tr>
<tr class="odd">
<td align="left">3月</td>
<td align="left">450</td>
<td align="left">17</td>
</tr>
<tr class="even">
<td align="left">4月</td>
<td align="left">700</td>
<td align="left">23</td>
</tr>
<tr class="odd">
<td align="left">5月</td>
<td align="left">650</td>
<td align="left">20</td>
</tr>
<tr class="even">
<td align="left">6月</td>
<td align="left">540</td>
<td align="left">17</td>
</tr>
</tbody>
</table>
<p>これから，最低の売上高は1月に実現し，最高の売上高は4月に実現している。また，それぞれコストは16億円と23.2億円である。したがって，高低点法によれば，変動費率および固定費は次のように計算される。</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="07-単回帰.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 変動費率の計算</span></span>
<span id="cb107-2"><a href="07-単回帰.html#cb107-2" aria-hidden="true" tabindex="-1"></a>vr <span class="ot">&lt;-</span> (<span class="dv">23</span> <span class="sc">-</span> <span class="dv">16</span>) <span class="sc">/</span> (<span class="dv">700</span> <span class="sc">-</span> <span class="dv">300</span>)</span>
<span id="cb107-3"><a href="07-単回帰.html#cb107-3" aria-hidden="true" tabindex="-1"></a>vr</span></code></pre></div>
<pre><code>## [1] 0.0175</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="07-単回帰.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 最高の営業時の変動費</span></span>
<span id="cb109-2"><a href="07-単回帰.html#cb109-2" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> vr <span class="sc">*</span> <span class="dv">700</span></span>
<span id="cb109-3"><a href="07-単回帰.html#cb109-3" aria-hidden="true" tabindex="-1"></a>vc</span></code></pre></div>
<pre><code>## [1] 12.25</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="07-単回帰.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 固定費の計算</span></span>
<span id="cb111-2"><a href="07-単回帰.html#cb111-2" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fl">23.2</span> <span class="sc">-</span> vc</span>
<span id="cb111-3"><a href="07-単回帰.html#cb111-3" aria-hidden="true" tabindex="-1"></a>fc</span></code></pre></div>
<pre><code>## [1] 10.95</code></pre>
<p>つまり，変動費率は0.0175，固定費は10.95億円と計算できた。</p>
<p>ただし，後述する最小二乗法を含めた固変分解の方法は，それぞれ一長一短あり，普遍的に正しい方法ではないことに注意が必要である。固変分解をするには，それぞれの方法の特徴を理解した上で，適切に選択することが必要である。</p>
</div>
<div id="cvp分析における仮定" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> CVP分析における仮定</h3>
<p>CVP分析は実務的にも広く用いられている管理会計ツールであるが，その背後にはいくつかの仮定が置かれていることに注意する必要がある<span class="citation">(<a href="08-重回帰.html#ref-T2018Pbook" role="doc-biblioref">高田 2018, 221</a>)</span>。</p>
<ul>
<li>変動費と固定費の分解が正しく行われていること。</li>
<li>固定費は，ある期間一定であること。</li>
<li>一定期間の間，変動費率に変化がないこと。</li>
<li>製品構成に変化がないこと。</li>
<li>異常な費用や損失の発生がないこと。</li>
</ul>
<p>もちろん，現実的にはこれらの仮定を全て満たすことは限りなく不可能に近いだろう。したがって，CVP分析に基づく予測や分析結果は必ずしも精度が高いとは限らないことを頭の片隅に置いておくことが重要である。</p>
<p>しかし，仮にそうであったとしても，CVP分析が一定の有用な情報内容を含んでいることやその簡便さから，実務的に普及しているのだろう。</p>
</div>
</div>
<div id="最小二乗法を利用した固変分解" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> 最小二乗法を利用した固変分解</h2>
<p></p>
<div id="データの確認" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> データの確認</h3>
<p></p>
<p>最小二乗法による固変分解の説明をする前に，まず，本節で利用するデータを読み込み，その中身を確認する。
データはこれまで利用してきた「data.csv」を利用する。</p>
<p>まずは作業環境をリセットし，分析に必要なパッケージおよび，それぞれのデータを読み込んで，必要な変数を抜き出してみよう。
ここでは，売上高と販管費と業種に関する情報を抜き出す。</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="07-単回帰.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 作業環境のリセット</span></span>
<span id="cb113-2"><a href="07-単回帰.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">all =</span> <span class="cn">TRUE</span>))</span>
<span id="cb113-3"><a href="07-単回帰.html#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="07-単回帰.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb113-5"><a href="07-単回帰.html#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="07-単回帰.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co"># データの読み込み</span></span>
<span id="cb113-7"><a href="07-単回帰.html#cb113-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data.csv&quot;</span>,</span>
<span id="cb113-8"><a href="07-単回帰.html#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">&quot;cp932&quot;</span>)</span>
<span id="cb113-9"><a href="07-単回帰.html#cb113-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb113-10"><a href="07-単回帰.html#cb113-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb113-11"><a href="07-単回帰.html#cb113-11" aria-hidden="true" tabindex="-1"></a>        sales,</span>
<span id="cb113-12"><a href="07-単回帰.html#cb113-12" aria-hidden="true" tabindex="-1"></a>        sga,</span>
<span id="cb113-13"><a href="07-単回帰.html#cb113-13" aria-hidden="true" tabindex="-1"></a>        ind</span>
<span id="cb113-14"><a href="07-単回帰.html#cb113-14" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## 
## ─ Column specification ────────────────────────────
## cols(
##   id = col_double(),
##   name = col_character(),
##   sales = col_double(),
##   cogs = col_double(),
##   sga = col_double(),
##   asset = col_double(),
##   debt = col_double(),
##   equity = col_double(),
##   receivable = col_double(),
##   inventory = col_double(),
##   payable = col_double(),
##   tax = col_double(),
##   ind = col_character(),
##   ope_inc = col_double(),
##   roa = col_double(),
##   margin = col_double(),
##   turnover = col_double(),
##   employees = col_double()
## )</code></pre>
<p>それではまず，データの特徴を確認しおこう。
我々が今関心があるのは，売上高とコストの関係性である。
それらの関係性を視覚的にとらえるために，散布図を描いてみよう。
散布図を描くには，ggplot2パッケージの<code>geom_point()</code>関数を利用すればよい。</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="07-単回帰.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 販管費の散布図</span></span>
<span id="cb115-2"><a href="07-単回帰.html#cb115-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb115-3"><a href="07-単回帰.html#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sales, <span class="at">y =</span> sga)) <span class="sc">+</span></span>
<span id="cb115-4"><a href="07-単回帰.html#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb115-5"><a href="07-単回帰.html#cb115-5" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="%E4%B8%8B%E6%BA%96%E5%82%99_files/figure-html/unnamed-chunk-53-1.png" width="500px" style="display: block; margin: auto;" /></p>
<p>散布図を確認すると，縦軸に「e」と表記されている。これは，指数を表すexponentialの頭文字のeである。
具体的には，1e+05であれば，<span class="math inline">\(1*10^5=100000\)</span>を表すこととなる。
2e+05であれば，<span class="math inline">\(2*10^5=200000\)</span>を表すこととなる。
余談ではあるが，この表記は数値が小さいときにも利用される。
たとえば，1e-5であれば，<span class="math inline">\(1*10^-5=0.00001\)</span>を表すこととなる。</p>
<p>それでは，つぎに，それぞれの業種を区別するために，異なる色をつけて散布図を描いてみよう。</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="07-単回帰.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 販管費の散布図（業種ごとの色付き）</span></span>
<span id="cb116-2"><a href="07-単回帰.html#cb116-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="07-単回帰.html#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sales, <span class="at">y =</span> sga, <span class="at">color =</span> ind)) <span class="sc">+</span></span>
<span id="cb116-4"><a href="07-単回帰.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb116-5"><a href="07-単回帰.html#cb116-5" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="%E4%B8%8B%E6%BA%96%E5%82%99_files/figure-html/unnamed-chunk-54-1.png" width="500px" style="display: block; margin: auto;" /></p>
<p>ggplot2では，<code>facet_wrap()</code>関数や<code>facet_grid()</code>関数利用することで，条件ごとにグラフを出力することもできる。
ここでは<code>facet_wrap()</code>関数について説明する。
<code>facet_wrap()</code>関数では，<code>facet_wrap(~ variable)</code>と記述することによって，条件ごとにグラフを表示できる。
<code>variable</code>には条件となる変数を入れてやればよい。
それでは，先ほど作成した<code>g</code>(全体の散布図)に加える形で業種ごとの散布図を描いてみよう。</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="07-単回帰.html#cb117-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> ind)</span></code></pre></div>
<p><img src="%E4%B8%8B%E6%BA%96%E5%82%99_files/figure-html/unnamed-chunk-55-1.png" width="500px" style="display: block; margin: auto;" /></p>
<p>散布図を確認すると，両業種ともに売上高と販管費には正の関係が見られそうである。
また，家電業界で非常に規模の大きなサンプルが入っていることが分かるものの，業種間の大きな違いは見られなさそうである。</p>
<p>統計分析において，こうした非常に大きな（または小さな）値の観測値は，除外されることがある。
通常，統計分析において利用されるサンプルは，分析において想定される母集団を適切に代表している必要がある。
そのため，異常な値はサンプルから除外されたり（trim：トリム），特定の値で置き換える（winsorize：ウィンザライズ）といった処理がなされる。</p>
<p>そこで，ここでは売上高とコストに関して，上限値から1%のサンプルを除外して分析を進めてみよう。
そのことによって，上図の異常な値はサンプルから除外されるはずである。</p>
<p>サンプルを除外するために，<code>quantile()</code>関数を用いて基準となる値を特定し<a href="#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a>，<code>filter()</code>関数によってデータを絞り込む。まずは，売上高とコストに関して上限1%の値を特定し，それらの値以上の観測値をサンプルから除外する。</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="07-単回帰.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 上限1％の値を特定する</span></span>
<span id="cb118-2"><a href="07-単回帰.html#cb118-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="07-単回帰.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb118-4"><a href="07-単回帰.html#cb118-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sales_99 =</span> <span class="fu">quantile</span>(sales, <span class="fl">0.99</span>),</span>
<span id="cb118-5"><a href="07-単回帰.html#cb118-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sga_99 =</span> <span class="fu">quantile</span>(sga, <span class="fl">0.99</span>)</span>
<span id="cb118-6"><a href="07-単回帰.html#cb118-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   sales_99  sga_99
##      &lt;dbl&gt;   &lt;dbl&gt;
## 1 1449800. 366996.</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="07-単回帰.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 上限10％以上の観測値を除外する</span></span>
<span id="cb120-2"><a href="07-単回帰.html#cb120-2" aria-hidden="true" tabindex="-1"></a>df_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="07-単回帰.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb120-4"><a href="07-単回帰.html#cb120-4" aria-hidden="true" tabindex="-1"></a>    sales <span class="sc">&lt;</span> <span class="fl">1449799.52</span>,</span>
<span id="cb120-5"><a href="07-単回帰.html#cb120-5" aria-hidden="true" tabindex="-1"></a>    sga <span class="sc">&lt;</span> <span class="fl">366995.58</span></span>
<span id="cb120-6"><a href="07-単回帰.html#cb120-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>実際に，<code>nrow()</code>関数を利用して，除外前後のサンプルの行数を比較すると，1社減少していることがわかる。</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="07-単回帰.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df) <span class="sc">-</span> <span class="fu">nrow</span>(df_1)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>念の為，除外後の散布図を描くと，次のようになる。
先程の非常に大きな値を取る観測値が除外されていることを目視で確認しよう。</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="07-単回帰.html#cb123-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> df_1 <span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="07-単回帰.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sales, <span class="at">y =</span> sga, <span class="at">color =</span> ind)) <span class="sc">+</span></span>
<span id="cb123-3"><a href="07-単回帰.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-4"><a href="07-単回帰.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ind)</span>
<span id="cb123-5"><a href="07-単回帰.html#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="07-単回帰.html#cb123-6" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="%E4%B8%8B%E6%BA%96%E5%82%99_files/figure-html/unnamed-chunk-58-1.png" width="500px" style="display: block; margin: auto;" /></p>
<p>CVP分析では売上高とコストの関係性を捉える直線を求める。
たとえば，前節で述べた高低点法では最高の売上高と最低の売上高の2点を選び，その直線関係によって，コストと売上高の関係をとらえる。
他方，スキャッターチャート法では，与えられた散布図を見て目分量で直線を引く方法である。
これから説明する最小二乗法では，与えられたデータを利用して，数学的に最も当てはまりの良い直線を求める。</p>
</div>
<div id="最小二乗法に関する予備知識" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> 最小二乗法に関する予備知識</h3>
<p></p>
<p>最小二乗法は様々な分野で利用される回帰分析における統計分析の方法の一種である。
回帰分析は，要因となる変数（説明変数）と結果となる変数（被説明変数）の関係性を探る。
CVP分析では，とくに，単回帰分析を固変分解に利用できる。</p>
<p>単回帰分析では，1つの説明変数が被説明変数に与える影響を分析する<a href="#fn34" class="footnote-ref" id="fnref34"><sup>34</sup></a>。
ただし，細かい計算過程については，統計学や計量経済学のテキストを参照せよ。
ここでは，コストを被説明変数，売上高を説明変数とした単回帰分析を考える。</p>
<p>今，ある企業のコストと売上高の関係が次の直線で表されているとしよう。
なお，ここで，<span class="math inline">\(y\)</span>はコスト，<span class="math inline">\(x\)</span>は売上高，<span class="math inline">\(i\)</span>は企業を表すと考える。</p>
<p><span class="math display">\[\begin{align}
    y_i = \alpha + \beta x_i.
    \label{eq:6.2}
\end{align}\]</span></p>
<p>このとき，<span class="math inline">\(y_i\)</span>は<span class="math inline">\(\alpha\)</span>(固定費)と<span class="math inline">\(\beta x_i\)</span>(変動費)によって完全に表現される。
もし仮に，全てのデータが一直線上に並んでいるような場合であれば，このようなコストと売上高の直線関係を考えることができる。</p>
<p>ただし，通常そのようなことはありえない。
なぜなら，売上高と固定費，変動費の関係は，工場内での作業効率や，為替や景気変動といった非常に様々な要因から影響を受ける。
したがって，現実に観察されるコストのデータは，必ずしも一直線上にあるとは限らず，むしろそうした直線からズレることが多い。
いま，このズレのことを<span class="math inline">\(\varepsilon_i\)</span>とすると，コストと売上高の関係を表す()式は次のように書き換えられる。</p>
<p><span class="math display">\[\begin{equation}
    y_i = \alpha + \beta x_i + \varepsilon_i.
    \label{eq:6.3}
\end{equation}\]</span></p>
<p>ここで，<span class="math inline">\(\varepsilon_i\)</span>は説明変数で説明しきれなかった部分をとらえている。
したがって，このズレが小さいほど，コストと売上高の関係性を表す式として望ましいことが直感的に理解できるだろう。</p>
<p>そこで，最小二乗法ではこのズレが最小となる直線を求める。
()式を変形すると次のようになる。</p>
<p><span class="math display">\[\begin{align}
    \varepsilon_i = y_i - \alpha - \beta x_i.
    \label{eq:6.4}
\end{align}\]</span></p>
<p>上述したように，最小二乗法では，この<span class="math inline">\(\varepsilon_i\)</span>を最小にする<span class="math inline">\(\alpha\)</span>と<span class="math inline">\(\beta\)</span>を導出する。
最も単純な方法では，すべての企業の<span class="math inline">\(\varepsilon_i\)</span>を足し合わせることが考えられる。
しかし，<span class="math inline">\(\varepsilon_i\)</span>は正の値と負の値の両方を取りうるので，相殺し合う可能性がある。
そこで，<span class="math inline">\(\Sigma (\varepsilon_i)^2\)</span> を最小にすることによって，<span class="math inline">\(\alpha\)</span>と<span class="math inline">\(\beta\)</span>を導出する。</p>
<p>細かい計算過程については統計学のテキストに譲るとして，最終的に<span class="math inline">\(\alpha\)</span>と<span class="math inline">\(\beta\)</span>は次のように導出される。</p>
<p><span class="math display">\[\begin{align*}
    \beta &amp;= \frac{x \mbox{と} y \mbox{の共分散}}{x \mbox{の分散}}, \\
    \alpha &amp;= \bar{y} -\beta \bar{x}.
\end{align*}\]</span></p>
<p>ここで，<span class="math inline">\(\bar{y}\)</span>はコストの平均値，<span class="math inline">\(\bar{x}\)</span>は売上高の平均値を表す。
最小二乗法によって推定される<span class="math inline">\(\beta\)</span>は，回帰直線の傾きであり，<span class="math inline">\(x\)</span>が1単位変化すると，<span class="math inline">\(y\)</span>がどれだけ変化するかを表す。
すなわち，CVP関係としてとらえると，<span class="math inline">\(\beta\)</span>は変動費率を表す。</p>
<p>一方，<span class="math inline">\(\alpha\)</span>は回帰直線の切片であり，売上高が0であってもかかるコストを表していることから，固定費であると解釈できる。</p>
</div>
<div id="最小二乗法の実践" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> 最小二乗法の実践</h3>
<p>それでは，販管費を最小二乗法によって，固変分解してみよう。最小二乗法は<code>lm()</code>関数を用いて行う。<code>lm()</code>関数では，以下のように記述をする。</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="07-単回帰.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( 被説明変数 <span class="sc">~</span> 説明変数, data）</span></code></pre></div>
<p>とすることで，係数の推定を行える。
今回は独立変数が1つだけの場合を扱っているが，独立変数が複数ある重回帰分析の場合には，独立変数を複数配置する。
特徴としては，被説明変数と説明変数が「<code>~</code>（チルダ）」で結ばれている点である。
説明変数が複数ある場合には，説明変数同士を「<code>+</code>」で結んでやればよい（詳しくは次章を参照されたい）。
販管費を最小二乗法によって固変分解をする際には，販管費が被説明変数，売上高が説明変数であると考えてやればよい。</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="07-単回帰.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 販管費を用いたCVP分析</span></span>
<span id="cb125-2"><a href="07-単回帰.html#cb125-2" aria-hidden="true" tabindex="-1"></a>cvp <span class="ot">&lt;-</span> <span class="fu">lm</span>(sga <span class="sc">~</span> sales, <span class="at">data =</span> df_1)</span>
<span id="cb125-3"><a href="07-単回帰.html#cb125-3" aria-hidden="true" tabindex="-1"></a>cvp</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sga ~ sales, data = df_1)
## 
## Coefficients:
## (Intercept)        sales  
## -12338.7507       0.2506</code></pre>
<p>出力された結果を確認すると，「Call」には推定された式が表示される。
「Coefficients」と書かれた部分に<span class="math inline">\(\alpha\)</span>や<span class="math inline">\(\beta\)</span>といった係数の推定値に関する情報が書かれている。
「(Intercept)」には定数項に対する推定値（すなわち，<span class="math inline">\(\alpha\)</span>の値）が，「sales」には売上高の係数に対する推定値（すなわち，<span class="math inline">\(\beta\)</span>の値）が記載されている。
それぞれの数値を確認すると，固定費は$-$12,340万円，変動費率は0.2506であることを示している。
このように最小二乗法を用いた固変分解では，固定費が負の値で推定されてしまうこともあるので注意が必要である。
データに異常な値が含まれていないかどうかや，データのサイズは十分な大きさかどうかを事前にチェックする必要があるだろう。</p>
<p>最小二乗法による推定値に関する統計的な情報は，<code>summary()</code>関数を利用することによって，確認できる。
<code>summary()</code>関数を利用すると，各係数の推定値が0と有意に異なるかどうかを確認できる。
今回はCVP分析における固変分解において回帰分析の手法を利用したが，回帰分析は一般には仮説検証の場面において利用されることが多い。
そのような場合には，統計量に関わる情報が非常に役に立つ。</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="07-単回帰.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cvp)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sga ~ sales, data = df_1)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -39956  -3989   4584   9808  23108 
## 
## Coefficients:
##                 Estimate   Std. Error t value      Pr(&gt;|t|)    
## (Intercept) -12338.75069  11224.30590  -1.099         0.289    
## sales            0.25065      0.02165  11.580 0.00000000703 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18060 on 15 degrees of freedom
## Multiple R-squared:  0.8994, Adjusted R-squared:  0.8927 
## F-statistic: 134.1 on 1 and 15 DF,  p-value: 0.000000007027</code></pre>
<p>上から順に出力結果を確認すると，「Call」には先程と同じく推定された式が表示されている。
「Residuals」には残差<a href="#fn35" class="footnote-ref" id="fnref35"><sup>35</sup></a>に関する情報が示されている。
「Coefficients」にも先程と同様に係数に関する情報が書かれている。
その中で，「Estimates」という列には係数に対する推定値が書かれている。
「Std. Error」という列には推定値の標準誤差が，「t value」という列には推定値のt値が，「Pr(&gt;|t|) 」という列には推定値のp値が記載されている。
また，一番右端の「<span class="math inline">\(\mbox{***}\)</span>」や「.」といった記号はp値がどの有意水準より小さいかを示している。
基準となる有意水準は「Signif. codes」という行に示されている。
これらの記号はそれぞれ，「<span class="math inline">\(\mbox{***}\)</span>」であればp値が0と0.001の間に，「<span class="math inline">\(\mbox{**}\)</span>」であればp値が0.001と0.01との間に，「<span class="math inline">\(\mbox{*}\)</span>」であればp値が0.01と0.05との間に，「.」であればp値が0.05と0.1の間に存在することを意味する。
何も記号がついていなければp値は0.1と1の間に存在する。</p>
<p>「(Intercept)」という行を確認すると，定数項に対する推定値（<span class="math inline">\(\alpha\)</span>の値）は10％の水準で有意であることが，また「sales」の行を確認すると，売上高に対する推定値（<span class="math inline">\(\beta\)</span>の値）は0.1％の水準で有意であることが分かる。</p>
<p>なお，残りの部分には，残差の標準誤差や自由度，決定係数，F検定に関する結果が示されている。</p>
<p>このように<code>summary()</code>関数には様々な情報が記載されているが，特定の情報のみを取り出すこともできる。
なお，たとえば係数や決定係数のみを出力したい場合には，「$」を利用してその中身のみを指定できる<a href="#fn36" class="footnote-ref" id="fnref36"><sup>36</sup></a>。</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="07-単回帰.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cvp)<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##                   Estimate     Std. Error   t value         Pr(&gt;|t|)
## (Intercept) -12338.7506905 11224.30589791 -1.099289 0.28897321910477
## sales            0.2506499     0.02164582 11.579598 0.00000000702675</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="07-単回帰.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cvp)<span class="sc">$</span>adj.r</span></code></pre></div>
<pre><code>## [1] 0.8926802</code></pre>
<p>それではつづいて，業種ごとに固変分解を行ってみよう。
業種ごとに分析をするためには，それぞれの業種で回帰分析を実行することとなる。
一番シンプルな方法は，<code>filter()</code>関数でそれぞれの業種だけのサンプルを作成し，それぞれのサンプルで回帰分析を実行することであろう。
まずはサンプルを絞る。</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="07-単回帰.html#cb133-1" aria-hidden="true" tabindex="-1"></a>df_ds <span class="ot">&lt;-</span> df_1 <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="07-単回帰.html#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb133-3"><a href="07-単回帰.html#cb133-3" aria-hidden="true" tabindex="-1"></a>        ind <span class="sc">==</span> <span class="st">&quot;DrugStore&quot;</span></span>
<span id="cb133-4"><a href="07-単回帰.html#cb133-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb133-5"><a href="07-単回帰.html#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="07-単回帰.html#cb133-6" aria-hidden="true" tabindex="-1"></a>df_er <span class="ot">&lt;-</span> df_1 <span class="sc">%&gt;%</span></span>
<span id="cb133-7"><a href="07-単回帰.html#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb133-8"><a href="07-単回帰.html#cb133-8" aria-hidden="true" tabindex="-1"></a>        ind <span class="sc">==</span> <span class="st">&quot;ElectronicsRetail&quot;</span></span>
<span id="cb133-9"><a href="07-単回帰.html#cb133-9" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p>回帰分析については先程定義した「cvp」を利用できる。
そのためには<code>update()</code>関数を利用しよう。
<code>update()</code>関数では，回帰式の変数の一部のみを変更する場合や，適用するデータを変更する際などに利用できる関数である。
<code>update()</code>関数はつぎのように記述する。</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="07-単回帰.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(元の回帰式を格納したオブジェクト,.<span class="sc">~</span>., 新たなデータ)</span></code></pre></div>
<p>まず，environmentにある元の回帰式を格納したオブジェクトを記述する。
つぎに「<code>.~.</code>」は回帰式の修正に利用する項目である。
「<code>.</code>」は元の回帰式の変数を意味している。
特に修正する必要がない場合には，この部分は省略しても構わない。
「<code>~</code>」は通常のlm関数のときと同様に，被説明変数と説明変数を結んでいる。
たとえば，被説明変数に新たに別のコストとして売上原価(cogs)を利用したければ，次のようにしてやればよい。
（ただし，ここで利用しているデータにはcogsという変数がないので下のコードは実際には機能しない）</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="07-単回帰.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(cvp, cogs <span class="sc">~</span> . , <span class="at">data =</span> df_1)</span></code></pre></div>
<p>また，変数を追加する場合には「<code>+</code>」，変数を減らす場合には「<code>-</code>」というふうに記述する。</p>
<p>たとえば，説明変数に新たにgdpという変数を加えたければ，</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="07-単回帰.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(cvp, . <span class="sc">~</span> . <span class="sc">+</span> gdp , <span class="at">data =</span> df_1)</span></code></pre></div>
<p>としてやればよい。</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="07-単回帰.html#cb137-1" aria-hidden="true" tabindex="-1"></a>cvp_ds <span class="ot">&lt;-</span> <span class="fu">update</span>(cvp, <span class="at">data =</span> df_ds)</span>
<span id="cb137-2"><a href="07-単回帰.html#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="07-単回帰.html#cb137-3" aria-hidden="true" tabindex="-1"></a>cvp_ds</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sga ~ sales, data = df_ds)
## 
## Coefficients:
## (Intercept)        sales  
## -23238.7204       0.2621</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="07-単回帰.html#cb139-1" aria-hidden="true" tabindex="-1"></a>cvp_er <span class="ot">&lt;-</span> <span class="fu">update</span>(cvp, <span class="at">data =</span> df_er)</span>
<span id="cb139-2"><a href="07-単回帰.html#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="07-単回帰.html#cb139-3" aria-hidden="true" tabindex="-1"></a>cvp_er</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sga ~ sales, data = df_er)
## 
## Coefficients:
## (Intercept)        sales  
##   -395.8677       0.2423</code></pre>
<p>分析の結果，ドラッグストア業界の固定費は$-<span class="math inline">\(23,240百万円，変動費率は0.2621であることが分かる。 また，家電量販店業界の固定費は\)</span>-$395.8677百万円，変動費率は0.2423であることが分かる。</p>
<p>今回の例のように，最小二乗法による固変分解は万能ではなく，しばしば問題を伴う。
たとえば，変動費率が1を超えてしまうことや，固定費がしばしば負の値として推定される問題が指摘されているので注意してほしい<span class="citation">(<a href="08-重回帰.html#ref-FA2012HSMR" role="doc-biblioref">福嶋 and 新井 2012</a>; <a href="08-重回帰.html#ref-O2014Dbook" role="doc-biblioref">乙政 2014</a>; <a href="08-重回帰.html#ref-T2018Pbook" role="doc-biblioref">高田 2018</a>)</span>。</p>
<p>その理由としては，固定費が長期的には変動費化すること<span class="citation">(<a href="08-重回帰.html#ref-KC1998HBSP" role="doc-biblioref">Kaplan and Cooper 1987</a>)</span>，製品単位あたりの販売価格や変動費が一定であることや，在庫の存在が無視されるといったCVP分析の教科書的仮定からの逸脱，利益と関連する自由裁量費の存在<span class="citation">(<a href="08-重回帰.html#ref-FAM2014AP" role="doc-biblioref">福嶋, 新井, and 松尾 2014</a>)</span>などが考えられる。
CVP分析を行う際には，上記の問題を理解した上で，分析してほしい。</p>
<p>以上が最小二乗法を用いた固変分解の方法となる。売上高に対するコスト関数を推定することで，損益分岐点分析なども行うことができるようになる。
興味がある読者は，一般的な原価計算や管理会計のテキストを参照していただきたい。</p>

<div class="footnotes">
<hr />
<ol start="31">
<li id="fn31"><p>Volumeは厳密には，売上高に限定されるわけではなく，営業量や操業度を含む広い概念である。<a href="07-単回帰.html#fnref31" class="footnote-back">↩︎</a></p></li>
<li id="fn32"><p>コストを材料費，労務費，経費に分ける分類方法もある。詳しくは，原価計算のテキストを参照せよ。<a href="07-単回帰.html#fnref32" class="footnote-back">↩︎</a></p></li>
<li id="fn33"><p>quantile()関数では任意の分位数を計算できる。その計算のアルゴリズムには9つのタイプが用意されているので，コンソールに「?quantile」と打ち込んで確認してみよう。<a href="07-単回帰.html#fnref33" class="footnote-back">↩︎</a></p></li>
<li id="fn34"><p>複数の説明変数を扱う回帰分析のことを重回帰分析と呼ぶが，その詳細については次章で説明する。<a href="07-単回帰.html#fnref34" class="footnote-back">↩︎</a></p></li>
<li id="fn35"><p>残差とは，実際の観測値と推定された回帰式の基づく予測値の差を表す。回帰分析を学習する上では非常に重要な概念ではあるが，ここでは扱わない。興味のある読者は，統計学や計量経済学のテキストを参照せよ。<a href="07-単回帰.html#fnref35" class="footnote-back">↩︎</a></p></li>
<li id="fn36"><p>Rのコンソールに「<code>?lm</code>」や「<code>?summary.lm</code>」と入力し，それぞれの関数にどのような値が用意されているか確認してみよう。<a href="07-単回帰.html#fnref36" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="06-会計情報の検定.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="08-重回帰.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["下準備.pdf", "下準備.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
